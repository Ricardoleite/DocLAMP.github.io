{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# MHD-Natural Convection\n",
    "\n",
    "-------------------"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Square Enclosure\n",
    "\n",
    "Consider a two-dimensional enclosure of height $H$ and horizontal length $L$. The enclosure is filled with a Newtonian fluid such as air or water.\n",
    "\n",
    "<img src=\"MHD-Nat2.png\" style=\"width:300px;height:300px\"/>\n",
    "\n",
    "We are interested in the transient behavior of the cavity fluid as the sidewalls are instantaneously heated and, respectively, cooled to temperatures $+\\Delta T/2$ and $-\\Delta T/2$. The top and bottom walls $(y=0,H)$ remain insulated throughout this experiment. Initially, the fluid is isothermal $(T=0)$ and motionless $(u=v=0)$ everywhere inside the cavity."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Balance Equations\n",
    "\n",
    "The equations governing the conservation of mass, momentum, and energy at\n",
    "every point in the cavity are\n",
    "\n",
    "$\\displaystyle\\frac{\\partial u}{\\partial x}+\\frac{\\partial v}{\\partial y}=0$\n",
    "\n",
    "$\\displaystyle\\frac{\\partial u}{\\partial t}+u \\frac{\\partial u}{\\partial x}+v \\frac{\\partial u}{\\partial y}=-\\frac{1}{\\rho} \\frac{\\partial P}{\\partial x}+\\nu\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}+\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)-\\displaystyle\\frac{\\sigma B_{0}^{2}}{\\rho}u$\n",
    "\n",
    "$\\displaystyle\\frac{\\partial v}{\\partial t}+u \\frac{\\partial v}{\\partial x}+v \\frac{\\partial v}{\\partial y}=-\\frac{1}{\\rho} \\frac{\\partial P}{\\partial y}+\\nu\\left(\\frac{\\partial^{2} v}{\\partial x^{2}}+\\frac{\\partial^{2} v}{\\partial y^{2}}\\right)-g\\left[1-\\beta\\left(T-T_{0}\\right)\\right]$\n",
    "\n",
    "$\\displaystyle\\frac{\\partial T}{\\partial t}+u \\frac{\\partial T}{\\partial x}+v \\frac{\\partial T}{\\partial y}=\\alpha\\left(\\frac{\\partial^{2} T}{\\partial x^{2}}+\\frac{\\partial^{2} T}{\\partial y^{2}}\\right)$\n",
    "\n",
    "Note that in writing these equations, we modeled the fluid as Boussinesq-incompressible, in other words, $\\rho=constant$ everywhere except in the body force term of the $y$ momentum equation, where it is replaced by $\\rho[1-\\beta (T-T_{0})]$. The fluid is permeated by a uniform magnetic field $B_{0}$ along the y direction, parallel to gravity. Further we assume that the induced electric current does not distort appreciably the applied magnetic field."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Análise de Escala - Bejan\n",
    "\n",
    "Instead of solving the above equations numerically, we rely on pure scale analysis to predict theoretically the types of flow and heat transfer patterns that can develop in the enclosure. Immediately after $t=0$, the fluid bordering each sidewall is motionless: This means that near the sidewall, the energy equation expresses a balance between thermal inertia and conduction normal to the wall,\n",
    "\n",
    "$\\frac{\\Delta T}{t} \\sim \\alpha \\frac{\\Delta T}{\\delta_{T}^{2}}.$\n",
    "\n",
    "This equality of scales follows from recognizing, $\\Delta T$, $t$, and $\\delta_{t}$ as the scales of changes in $T$, $t$, and $x$ in the energy equation. In the same equation, we took $u=v=0$; we also recognized that $\\partial^{2} T/\\partial y^{2} << \\partial^{2} T/\\partial x^{2}$ because near $t=0^{+}$,the thermal boundary layer thickness $\\delta_{t}$ is much smaller than the enclosure height (note that $y\\sim H$ and $x \\sim \\delta_{t})$. A equação acima dictates that immediately following $t=0$ each sidewall is coated with a conduction layer the thickness of which increases as\n",
    "\n",
    "$\\delta_{T} \\sim(\\alpha t)^{1 / 2}.$\n",
    "\n",
    "The layer $\\delta_{T}$ rises along the heated wall. The velocity scale of this motion $v$ is easier to see if we first eliminate the pressure $P$ between the two momentum equations:\n",
    "\n",
    "$ \\begin{aligned} \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial v}{\\partial t}+u \\frac{\\partial v}{\\partial x}+v \\frac{\\partial v}{\\partial y}\\right)-\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial u}{\\partial t}+u \\frac{\\partial u}{\\partial x}+v \\frac{\\partial u}{\\partial y}\\right)= \\\\ =\\nu\\left[\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial^{2} v}{\\partial x^{2}}+\\frac{\\partial^{2} v}{\\partial y^{2}}\\right)-\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}+\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)\\right]+g \\beta \\frac{\\partial T}{\\partial x}+\\frac{\\sigma B_{0}^{2}}{\\rho}\\frac{\\partial u}{\\partial y} \\end{aligned}$\n",
    "\n",
    "This new equation contains four basic groups of terms: inertia terms on the left-hand side and four viscous diffusion terms plus the buoyancy and magnetism terms on the right-hand side. It is easy to show that the four terms that dominate each basic group are\n",
    "\n",
    "$\\underbrace{\\displaystyle\\frac{\\partial^{2} v}{\\partial x \\partial t}}_{Inertia}, \\quad \\quad  \\underbrace{\\nu\\displaystyle\\frac{\\partial^{3} v}{\\partial x^{3}}}_{Friction}, \\quad \\quad \\underbrace{g \\beta \\displaystyle\\frac{\\partial T}{\\partial x}}_{Buoyancy} , \\quad \\quad \\underbrace{\\displaystyle\\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{\\partial u}{\\partial y} \\rightarrow \\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{\\partial v}{\\partial x} }_{Magnetism}.$\n",
    "\n",
    "In terms of representative scales, the momentum balance:\n",
    "\n",
    "$\\displaystyle\\frac{v}{\\delta_{T} t}, \\quad\\quad \\nu \\displaystyle\\frac{v}{\\delta_{T}^{3}} \\quad\\quad \\sim \\quad \\displaystyle\\frac{g \\beta \\Delta T}{\\delta_{T}} , \\quad\\quad \\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{v}{\\delta_{T}} $\n",
    "\n",
    "The driving force in this balance is the buoyancy effect $(g\\beta\\Delta T)/\\delta_{T}$, wich is not zero. It is important to determine whether the buoyancy effect is balanced by friction or inertia. Dividing the above equation through the friction scale and recalling that $\\delta_{T}^{2}\\sim \\alpha t$ yields:\n",
    "\n",
    "$\\underbrace{\\displaystyle\\frac{1}{Pr}}_{Inertia}, \\quad \\quad  \\underbrace{1}_{Friction}, \\quad  \\sim \\quad \\underbrace{ \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v} }_{Buoyancy} , \\quad \\quad \\underbrace{\\displaystyle\\frac{\\sigma B_{0}^{2}\\delta_{T}^{2}}{\\rho\\nu} }_{Magnetism}  \\quad \\quad\n",
    "\\longrightarrow \\quad \\quad \\displaystyle\\frac{1}{Pr}+1- \\displaystyle\\frac{\\sigma B_{0}^{2}\\delta_{T}^{2}}{\\mu} \\approx \\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v}\n",
    "$\n",
    "\n",
    "Therefore, for fluids with Prandtl number of order 1 or greater, the correct\n",
    "momentum balance at $t=0^{+}$  is between buoyancy and friction,\n",
    "\n",
    "$1 \\quad \\sim \\quad \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v}  \\quad \\rightarrow \\quad v \\quad \\sim \\quad \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu }$\n",
    "\n",
    "This velocity scale is valid for fluids such as water and oils ($Pr>1$) and is marginally valid for gases ($Pr\\sim 1$)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Análise de Escala - Proposta\n",
    "\n",
    "Instead of solving the above equations numerically, we rely on pure scale analysis to predict theoretically the types of flow and heat transfer patterns that can develop in the enclosure. Immediately after $t=0$, the fluid bordering each sidewall is motionless: This means that near the sidewall, the energy equation expresses a balance between thermal inertia and conduction normal to the wall,\n",
    "\n",
    "$\\frac{\\Delta T}{t} \\sim \\alpha \\frac{\\Delta T}{\\delta_{T}^{2}}.$\n",
    "\n",
    "This equality of scales follows from recognizing, $\\Delta T$, $t$, and $\\delta_{t}$ as the scales of changes in $T$, $t$, and $x$ in the energy equation. In the same equation, we took $u=v=0$; we also recognized that $\\partial^{2} T/\\partial y^{2} << \\partial^{2} T/\\partial x^{2}$ because near $t=0^{+}$,the thermal boundary layer thickness $\\delta_{t}$ is much smaller than the enclosure height (note that $y\\sim H$ and $x \\sim \\delta_{t})$. A equação acima dictates that immediately following $t=0$ each sidewall is coated with a conduction layer the thickness of which increases as\n",
    "\n",
    "$\\delta_{T} \\sim(\\alpha t)^{1 / 2}.$\n",
    "\n",
    "The layer $\\delta_{T}$ rises along the heated wall. The velocity scale of this motion $v$ is easier to see if we first eliminate the pressure $P$ between the two momentum equations:\n",
    "\n",
    "$\\begin{aligned} \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial v}{\\partial t}+u \\frac{\\partial v}{\\partial x}+v \\frac{\\partial v}{\\partial y}\\right)-\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial u}{\\partial t}+u \\frac{\\partial u}{\\partial x}+v \\frac{\\partial u}{\\partial y}\\right)= \\\\ =\\nu\\left[\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial^{2} v}{\\partial x^{2}}+\\frac{\\partial^{2} v}{\\partial y^{2}}\\right)-\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}+\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)\\right]+g \\beta \\frac{\\partial T}{\\partial x}+\\frac{\\sigma B_{0}^{2}}{\\rho}\\frac{\\partial u}{\\partial y} \\end{aligned}$\n",
    "\n",
    "This new equation contains four basic groups of terms: inertia terms on the left-hand side and four viscous diffusion terms plus the buoyancy and magnetism terms on the right-hand side. It is easy to show that the four terms that dominate each basic group are\n",
    "\n",
    "$\\underbrace{\\displaystyle\\frac{\\partial^{2} v}{\\partial x \\partial t}}_{Inertia}, \\quad \\quad  \\underbrace{\\nu\\displaystyle\\frac{\\partial^{3} v}{\\partial x^{3}}}_{Friction}, \\quad \\quad \\underbrace{g \\beta \\displaystyle\\frac{\\partial T}{\\partial x}}_{Buoyancy} , \\quad \\quad \\underbrace{\\displaystyle\\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{\\partial u}{\\partial y} \\rightarrow \\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{\\partial v}{\\partial x} }_{Magnetism}.$\n",
    "\n",
    "In terms of representative scales, the momentum balance:\n",
    "\n",
    "$ \\displaystyle\\frac{v}{\\delta_{T} t}, \\quad\\quad \\nu \\displaystyle\\frac{v}{\\delta_{T}^{3}} \\quad\\quad \\sim \\quad \\displaystyle\\frac{g \\beta \\Delta T}{\\delta_{T}} , \\quad\\quad \\frac{\\sigma B_{0}^{2}}{\\rho} \\frac{v}{\\delta_{T}} $\n",
    "\n",
    "The driving force in this balance is the buoyancy effect $(g\\beta\\Delta T)/\\delta_{T}$, wich is not zero. It is important to determine whether the buoyancy effect is balanced by friction or inertia. Dividing the above equation through the friction scale and recalling that $\\delta_{T}^{2}\\sim \\alpha t$ yields:\n",
    "\n",
    "$\\underbrace{\\displaystyle\\frac{1}{Pr}}_{Inertia}, \\quad \\quad  \\underbrace{1}_{Friction}, \\quad  \\sim \\quad \\underbrace{ \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v} }_{Buoyancy} , \\quad \\quad \\underbrace{\\displaystyle\\frac{\\sigma B_{0}^{2}\\delta_{T}^{2}}{\\rho\\nu} }_{Magnetism}  \\quad \\quad\n",
    "\\longrightarrow \\quad \\quad \\displaystyle\\frac{1}{Pr}+1- \\displaystyle\\frac{\\sigma B_{0}^{2}\\delta_{T}^{2}}{\\mu} \\approx \\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v}\n",
    "$\n",
    "\n",
    "Therefore, for fluids with Prandtl number of order 1 or greater, the correct\n",
    "momentum balance at $t=0^{+}$  is between buoyancy and friction,\n",
    "\n",
    "$1 \\quad \\sim \\quad \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu v}  \\quad \\rightarrow \\quad v \\quad \\sim \\quad \\displaystyle\\frac{g\\beta\\Delta T\\delta_{T}^{2}}{\\nu }$\n",
    "\n",
    "This velocity scale is valid for fluids such as water and oils ($Pr>1$) and is marginally valid for gases ($Pr\\sim 1$)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next, we turn our attention back to the energy equation. The heat conducted\n",
    "from the sidewall into the fluid layer $\\delta_{T}$ is no longer spent solely on thickening the layer: Part of this heat input is carried away by the layer $\\delta_{T}$ rising with velocity $v$. Thus, in the energy equation, we see a competition among three distinct effects:\n",
    "\n",
    "$\\underbrace{\\displaystyle\\frac{\\Delta T}{t}}_{Inertia}, \\quad \\quad  \\underbrace{v\\displaystyle\\frac{\\Delta T}{H}}_{Convection}, \\quad \\quad \\underbrace{\\alpha\\displaystyle\\frac{\\Delta T}{\\delta_{T}^{2}}}_{Conduction}.$\n",
    "\n",
    "As $t$ increases, the convection effect increases [$v\\sim t$], while the\n",
    "effect of inertia decreases in importance. There comes a time $t_{f}$ when the energy equation expresses a balance between the heat conducted from the wall and the enthalpy carried away vertically by the buoyant layer,\n",
    "\n",
    "$v\\displaystyle\\frac{\\Delta T}{H}\\sim \\alpha\\frac{\\Delta T}{\\delta_{T}^{2}} \\quad \\rightarrow \\quad t_{f}\\sim \\left( \\frac{\\nu H}{g\\beta \\Delta T \\alpha} \\right)^{1/2}.$\n",
    "\n",
    "At such a time, the layer thickness is\n",
    "\n",
    "$\\delta_{T,f} \\sim (\\alpha t_{f})^{1/2} \\sim HRa^{-1/4}$\n",
    "\n",
    "where $Ra_{H}$ is the Rayleigh number based on the enclosure height,\n",
    "\n",
    "$Ra_{H}=\\displaystyle\\frac{g\\beta \\Delta T H^{3}}{\\alpha\\nu}.$\n",
    "\n",
    "The time $t_{f}$ when the $\\delta_{T}$ layer becomes convective could have also been determined by setting inertia ∼ convection in eq. (5.12). Note further that beyond the time $t_{f}$, the convection ∼ conduction balance in eq. (5.12) is preserved only if both $v$ and $\\delta_{T}$ no longer increase in time. Therefore, beyond $t\\sim t_{f}$, the thermal layers along each sidewall reach a steady state characterized by an energy balance between conduction and convection and a momentum balance between buoyancy and viscous diffusion.\n",
    "\n",
    "In addition to thermal layers of thickness $\\delta_{T,f}$, the sidewalls develop viscous (velocity) wall jets. The thickness of these jets $\\delta_{v}$ from the momentum balance (5.7) for the region of thickness $x \\sim \\delta_{v}$ outside the thermal layer. In this region, the buoyancy effect is minor, and we have a balance between inertia and viscous diffusion,\n",
    "\n",
    "$\\displaystyle\\frac{v}{\\delta_{v}t}\\sim \\nu\\frac{v}{\\delta_{v}^{3}} \\quad \\rightarrow \\quad \\delta_{v}\\sim (\\nu t)^{1/2} \\sim Pr^{1/2}\\delta_{T}.$\n",
    "\n",
    "In the steady state, $t > t_{f}$, the fluid near each sidewall is characterized by a two-layer structure: a thermal boundary layer of thickness $\\delta_{T,f}$ and a thicker wall jet $\\delta_{v,f} \\sim Pr^{1/2}\\delta_{T,f}$. The development of this structure is shown in Figura abaixo."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
